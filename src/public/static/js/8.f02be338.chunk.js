(this["webpackJsonplogin-screen"]=this["webpackJsonplogin-screen"]||[]).push([[8],{305:function(e,t,a){"use strict";a.r(t),t.default=a.p+"static/media/ringtone_minimal.011d7af4.ogg"},360:function(e,t,a){"use strict";a.r(t);var n=a(347),c=a(342),r=a(0),o=a.n(r),i=a(147),s=a(350),l=a(351),d=a(341),u=a(343),b=a(294),j=a.n(b),f=a(352),p=a(315),h=a(340),m=a(349),g=Object(h.a)((function(e){return Object(m.a)({root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},logo:{maxHeight:52,maxWidth:52}})}));function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function v(e,t){if(null==e)return{};var a,n,c=function(e,t){if(null==e)return{};var a,n,c={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(c[a]=e[a]);return c}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(c[a]=e[a])}return c}var x=r.createElement("g",{"data-item-type":"text","data-item":"Business",id:"logo__item--business",className:"logo__item"}),y=r.createElement("g",{"data-item-type":"image","data-item":"Image","data-logo-item":"",id:"logo__item--logo_0",className:"logo__item"},r.createElement("g",{className:"logo__item__inner",transform:"translate(853.5949391108932 363.5) scale(0.9309655130613976 0.9309655130613976) rotate(0 0 0)"},r.createElement("g",null,r.createElement("path",{fill:"#D06200",d:"M126.4,17.3H20.6v46.1c0.2-0.1,0.5-0.1,0.7-0.2c10.2-3,21.5-10.7,25.1-17.2c3.7-6.6-1.7-9.5-11.9-6.6   c-1.9,0.5-3.8,1.3-5.7,2.1c0.9-0.4,2-0.8,2.9-1.2c2.5-0.9,2.6-0.9,4-1.3l2-0.6c11.1-2.8,16.7,0.6,12.6,8C46.1,54.2,33,63.2,21,66.7   c-0.1,0-0.2,0.1-0.4,0.1v8.3c0.1,0,0.2,0,0.3-0.1c15.7-4.5,32.9-16.3,38.5-26.4c3.8-6.9,1.2-11.1-5.8-11.7c2.6,0.1,5.2,0.3,8.3,0.9   c4.7,1.1,5.4,1.2,9.1,2.5c5.7,2.1,7.2,7.3,3.1,14.7c-7.5,13.5-30.5,29.3-51.4,35.3c-0.7,0.2-1.4,0.4-2,0.5V102   c1.5-0.3,3-0.7,4.5-1.2c23.5-6.8,49.4-24.6,57.8-39.7c4-7.2,3.3-12.6-1.1-15.4c1.1,0.8,2.6,1.8,3.7,2.6c4,3,4.4,8.3,0.5,15.5   c-8.7,15.6-35.4,34-59.7,41c-2,0.6-3.9,1-5.8,1.4v6.7c2.5-0.5,5.2-1.1,8-1.9c25.2-7.3,53-26.3,62-42.6c3.8-6.8,3.7-12,0.4-15.3   c1.1,1.2,2.7,2.8,3.8,4.1l2.3,2.9c2.4,3.4,2.1,8.3-1.3,14.6c-9.3,16.7-37.8,36.3-63.7,43.8c-4.1,1.2-7.9,2-11.4,2.4v9.7   c4.7-0.1,10.3-1.1,16.6-2.9c25.9-7.5,54.5-27.1,63.7-43.8c3-5.4,3.6-9.8,2.2-13.1l0.6,1.6c0.7,2.1,1.7,5,2.3,7.2   c0.7,3-0.1,6.9-2.6,11.4c-9,16.2-36.8,35.3-62,42.6c-8.4,2.4-15.5,3.2-20.8,2.6v2.8c5.4,1.8,13.7,1.4,24.2-1.7   c24.3-7,51.1-25.4,59.8-41.1c2.1-3.9,3-7.2,2.7-9.9c0.1,1.4,0.3,3.2,0.3,4.5c0.1,2.5-0.8,5.5-2.6,8.9c-8.4,15.2-34.4,33-57.9,39.8   c-1.2,0.3-2.3,0.6-3.4,0.9h17.5c18.6-7.5,36.9-21.1,43.5-32.9c1.2-2.2,2-4.3,2.3-6.1c-0.9,4.5-1.2,6.1-2.2,9.1   c-1.6,4.4-1.9,5.1-3.8,8.9c0,0.1-0.1,0.2-0.1,0.2c-3.9,7.1-13.4,15-24.1,20.8h49.7V17.3z","data-part-id":"logo__item--logo_0__0"}),r.createElement("polygon",{fill:"#D06200",points:"20.6,15 128.7,15 128.7,138.3 132.8,11.5","data-part-id":"logo__item--logo_0__1"}))));function S(e,t){var a=e.title,n=e.titleId,c=v(e,["title","titleId"]);return r.createElement("svg",O({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",preserveAspectRatio:"xMidYMid meet",viewBox:"869 371 111 110",ref:t,"aria-labelledby":n},c),a?r.createElement("title",{id:n},a):null,x,y)}var C,E,w,k,A,N,_=r.forwardRef(S),L=(a.p,a(21)),T=a(14),R=a(10),I=function(){var e=g(),t=o.a.useState(null),a=Object(i.a)(t,2),n=a[0],c=a[1],r=Boolean(n),b=Object(L.b)();return Object(R.jsx)("div",{className:e.root,children:Object(R.jsx)(s.a,{position:"static",children:Object(R.jsxs)(l.a,{children:[Object(R.jsx)(d.a,{variant:"h6",className:e.title,children:Object(R.jsx)(_,{className:e.logo})}),Object(R.jsxs)("div",{children:[Object(R.jsx)(u.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){c(e.currentTarget)},color:"inherit",children:Object(R.jsx)(j.a,{})}),Object(R.jsx)(p.a,{id:"menu-appbar",anchorEl:n,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:r,onClose:function(){c(null)},children:Object(R.jsx)(f.a,{onClick:function(){c(null),b(Object(T.l)())},children:"Sign Out"})})]})]})})})},D=a(9),U=a(368),V=a(52),z=Object(h.a)((function(e){return Object(m.a)({paper:{position:"absolute",width:500,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},dialogText:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}})})),B=Object(V.a)((function(e){return{tooltip:{backgroundColor:e.palette.common.white,color:"rgba(0, 0, 0, 0.87)",boxShadow:e.shadows[1],fontSize:11}}}))(U.a),P=z,M=a(366),Y=a(202),H=a.n(Y),W=a(306),G=a.n(W),F=a(45),J=a(346),Q=a(314),X=a(35),K=a(43),q=a(59),Z=a(5),$=a.n(Z),ee=a(28),te=a(201),ae={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},ne={video:!0,audio:!0},ce=function(){C=new RTCPeerConnection(ae),w=C.createDataChannel("messenger");var e=q.a.getState().call.localStream;if(e){var t,a=Object(te.a)(e.getTracks());try{for(a.s();!(t=a.n()).done;){var n=t.value;C.addTrack(n,e)}}catch(c){a.e(c)}finally{a.f()}}C.ontrack=function(e){var t=Object(i.a)(e.streams,1)[0];q.a.dispatch(Object(X.h)(t))},C.ondatachannel=function(e){var t=e.channel;t.onopen=function(){console.log("Data channel established connection")},t.onmessage=function(e){var t=String(e.data);q.a.dispatch(Object(X.g)({message:t,from:"other",date:new Date}))}}},re=function(e,t){C.onnegotiationneeded=function(){console.log("onnegotiationneeded"),C.createOffer().then((function(e){return C.setLocalDescription(e)})).then((function(){C.localDescription&&ge({name:e,target:t,type:"video-offer",sdp:C.localDescription})})).catch((function(e){console.error("Failed to send offer to the remote peer through signaling server")}))},C.onicecandidate=function(a){a.candidate&&Oe({name:e,target:t,type:"to_receiver",candidate:a.candidate})}},oe=function(){var e=Object(ee.a)($.a.mark((function e(t){var a,n,c,r,o,s,l;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null===(a=q.a.getState().user.user)||void 0===a?void 0:a.displayName,!(t&&t.sdp&&n)){e.next=17;break}if(E=new RTCPeerConnection(ae),w=E.createDataChannel("messenger"),c=q.a.getState().call.localStream){r=Object(te.a)(c.getTracks());try{for(r.s();!(o=r.n()).done;)s=o.value,E.addTrack(s,c)}catch(d){r.e(d)}finally{r.f()}}return E.ontrack=function(e){var t=Object(i.a)(e.streams,1)[0];console.log("Streams",t.getTracks()),q.a.dispatch(Object(X.h)(t))},e.next=9,E.setRemoteDescription(t.sdp);case 9:return e.next=11,E.createAnswer();case 11:return l=e.sent,e.next=14,E.setLocalDescription(l);case 14:ve({name:n,target:t.target,answer:l}),E.onicecandidate=function(e){e.candidate&&Oe({name:n,target:t.target,type:"to_caller",candidate:e.candidate})},E.ondatachannel=function(e){var t=e.channel;t.onopen=function(){console.log("Data channel established connection")},t.onmessage=function(e){var t=String(e.data);q.a.dispatch(Object(X.g)({message:t,from:"other",date:new Date}))}};case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=Object(ee.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.setRemoteDescription(t.answer);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Failed to set remote description",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=Object(ee.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.type){e.next=10;break}if("to_receiver"!==t.type){e.next=7;break}return e.next=5,E.addIceCandidate(t.candidate);case 5:e.next=10;break;case 7:if("to_caller"!==t.type){e.next=10;break}return e.next=10,C.addIceCandidate(t.candidate);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Failed to add ICE candidate",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),le=function(){var e;if(C)e=C;else if(E)e=E;else{var t=q.a.getState().user.user,a=q.a.getState().call.name;t&&a&&ye(t,a)}return e},de=function(e){if(w&&"open"===w.readyState&&e){var t=String(e);w.send(t),q.a.dispatch(Object(X.g)({message:t,from:"me",date:new Date}))}},ue=function(e){var t=q.a.getState().call.localStream,a=q.a.getState().call.screenSharingStream,n=q.a.getState().call.isScreenSharing;if(e&&t){var c,r=e.getSenders().find((function(e){return e.track?"video"===e.track.kind:null}));if(r)null===(c=r.track)||void 0===c||c.stop(),t.getVideoTracks().length>0&&r.replaceTrack(t.getVideoTracks()[0]);q.a.dispatch(Object(X.i)(!1))}a&&n&&a.getTracks().forEach((function(e){return e.stop()}))},be=function(){var e=le();q.a.getState().call.isScreenSharing&&ue(e),q.a.dispatch(Object(X.a)()),C&&C.close(),E&&E.close(),w&&w.close()};!function(e){e.ACTIVE_USERS="ACTIVE_USERS",e.USERS_AVAILABLE="USERS_AVAILABLE",e.USERS_BUSY="USERS_BUSY"}(k||(k={})),function(e){e.CALL_ACCEPTED="CALL_ACCEPTED",e.CALL_REJECTED="CALL_REJECTED",e.CALL_UNAVAILABLE="CALL_UNAVAILABLE"}(A||(A={})),function(e){e.CALL_CONNECTION_TERMINATED="CALL_CONNECTION_TERMINATED"}(N||(N={}));var je,fe=function(e){var t=q.a.getState().user.user;e&&(null===t||void 0===t?void 0:t.displayName)&&je.emit("register-new-user",{displayName:null===t||void 0===t?void 0:t.displayName,fullName:null===t||void 0===t?void 0:t.fullName,socketId:e})},pe=function(e){switch(e.event){case k.ACTIVE_USERS:var t=e.payload;q.a.dispatch(function(e){return{type:K.a.SET_ACTIVE_USERS,payload:e}}(t));break;case k.USERS_AVAILABLE:var a=e.payload;q.a.dispatch(function(e){return{type:K.a.SET_AVAILABLE_USERS,payload:e}}(a));break;case k.USERS_BUSY:var n=e.payload;q.a.dispatch(function(e){return{type:K.a.SET_BUSY_USERS,payload:e}}(n))}},he=function(e){switch(e.response){case A.CALL_ACCEPTED:e&&e.target&&(q.a.dispatch(Object(X.b)(D.b.CALL_IN_PROGRESS)),q.a.dispatch(Object(X.k)({show:!1})),function(e){var t,a=null===(t=q.a.getState().user.user)||void 0===t?void 0:t.displayName;a&&(ce(),re(a,e))}(e.target));break;case A.CALL_REJECTED:case A.CALL_UNAVAILABLE:q.a.dispatch(Object(X.k)({type:"",show:!1})),q.a.dispatch(Object(X.b)(D.b.CALL_AVAILABLE))}},me=function(e){switch(e.status){case N.CALL_CONNECTION_TERMINATED:e&&e.target&&be()}},ge=function(e){je.emit("webRTC-offer",e)},Oe=function(e){je.emit("webRTC-candidate",e)},ve=function(e){je.emit("webRTC-answer",e)},xe=function(e){je.emit("callAttemptResponse",e)},ye=function(e,t){var a;e&&e.displayName&&t&&(a={name:e.displayName,target:t,status:N.CALL_CONNECTION_TERMINATED},je.emit("callStatusChange",a)),be()},Se=a(305),Ce=function(e){var t=Object(L.c)((function(e){return e.call.showCallDialog})),a=Object(L.c)((function(e){return e.user.user})),n=e.name,c=P(),r=function(){a&&function(e,t){e&&e.displayName&&t&&(xe({name:e.displayName,target:t,response:A.CALL_REJECTED}),q.a.dispatch(Object(X.b)(D.b.CALL_AVAILABLE)))}(a,n)},o=Object(R.jsxs)("div",{className:c.paper,children:[Object(R.jsx)("audio",{src:Se.default,autoPlay:!0,loop:!0}),Object(R.jsx)(B,{title:n,children:Object(R.jsxs)("h2",{style:{paddingBottom:25},id:"call-dialog-title",className:c.dialogText,children:["Calling: ",n]})}),Object(R.jsx)("p",{id:"call-dialog-description",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:Object(R.jsx)(J.a,{variant:"contained",startIcon:Object(R.jsx)(H.a,{color:"secondary",style:{fontSize:50}}),onClick:r,children:"Hang Up"})})]}),i=Object(R.jsxs)("div",{className:c.paper,children:[Object(R.jsxs)("h2",{style:{paddingBottom:25},id:"call-dialog-title",className:c.dialogText,children:["Call from: ",n]}),Object(R.jsxs)("p",{id:"call-dialog-description",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Object(R.jsx)("audio",{src:Se.default,autoPlay:!0,loop:!0}),Object(R.jsx)(J.a,{variant:"contained",startIcon:Object(R.jsx)(G.a,{style:{color:F.a[500],fontSize:50}}),onClick:function(){a&&function(e,t){e&&e.displayName&&t&&(q.a.dispatch(Object(X.k)({show:!1})),xe({name:e.displayName,target:t,response:A.CALL_ACCEPTED}),q.a.dispatch(Object(X.b)(D.b.CALL_IN_PROGRESS)))}(a,n)},children:"Answer"}),Object(R.jsx)(J.a,{variant:"contained",startIcon:Object(R.jsx)(H.a,{color:"secondary",style:{fontSize:50}}),onClick:r,children:"Hang Up"})]})]});return console.log(Se),Object(R.jsx)("div",{children:Object(R.jsx)(M.a,{open:t.show,"aria-labelledby":"call-dialog-title","aria-describedby":"call-dialog-description",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:t.show&&"caller"===t.type?o:i})})},Ee=Object(h.a)((function(e){return Object(m.a)({root:{height:"100%",position:"relative"},talking:{backgroundColor:"black"},pending:{backgroundColor:"#ffffff",backgroundImage:"url(\"data:image/svg+xml,%3Csvg width='80' height='80' viewBox='0 0 80 80' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%2342a5f5' fill-opacity='0.58'%3E%3Cpath d='M50 50c0-5.523 4.477-10 10-10s10 4.477 10 10-4.477 10-10 10c0 5.523-4.477 10-10 10s-10-4.477-10-10 4.477-10 10-10zM10 10c0-5.523 4.477-10 10-10s10 4.477 10 10-4.477 10-10 10c0 5.523-4.477 10-10 10S0 25.523 0 20s4.477-10 10-10zm10 8c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zm40 40c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8z' /%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")",height:"90vh"}})})),we=Object(h.a)((function(e){return Object(m.a)({button:{width:"50px",height:"50px"}})})),ke=o.a.memo((function(e){var t=e.onClickHandler,a=we();return Object(R.jsx)("button",{className:a.button,onClick:t,children:e.children})})),Ae=Object(h.a)((function(e){return Object(m.a)({buttonContainer:{display:"flex",position:"absolute",bottom:"5%",left:"50%",transform:"translateX(-50%)",zIndex:100}})})),Ne=a(308),_e=a.n(Ne),Le=a(307),Te=a.n(Le),Re=a(312),Ie=a.n(Re),De=a(311),Ue=a.n(De),Ve=a(309),ze=a.n(Ve),Be=a(310),Pe=a.n(Be),Me=o.a.memo((function(e){var t=Object(L.b)(),a=Ae(),n=e.currentUser,c=e.targetUserId,r=e.localStream,o=e.isScreenSharing,i=e.isCameraEnabled,s=e.isMicrophoneEnabled;return Object(R.jsxs)("div",{className:a.buttonContainer,children:[Object(R.jsx)(ke,{onClickHandler:function(){n&&c&&ye(n,c)},children:Object(R.jsx)(H.a,{color:"secondary",style:{fontSize:35}})}),Object(R.jsx)(ke,{onClickHandler:function(){!function(e){if(e){var t=le();t&&(console.log("ENABLE"),navigator.mediaDevices.getDisplayMedia({video:!0}).then((function(e){if(t){var a=t.getSenders();console.log("SENDERS",a),console.log("Video track",e.getVideoTracks());var n=a.find((function(t){return t.track.kind===e.getVideoTracks()[0].kind}));console.log("SENDER",n),n&&n.replaceTrack(e.getVideoTracks()[0]),q.a.dispatch(Object(X.i)(!0)),e.getVideoTracks()[0].onended=function(){ue(t)},q.a.dispatch(Object(X.j)(e))}})).catch((function(e){console.error("Screen share failed",e)})))}else{var a=le();a&&ue(a)}}(!o)},children:o?Object(R.jsx)(Te.a,{color:"secondary",style:{fontSize:35}}):Object(R.jsx)(_e.a,{color:"primary",style:{fontSize:35}})}),Object(R.jsx)(ke,{onClickHandler:function(){var e=s;r&&(r.getAudioTracks()[0].enabled=!e,t(Object(X.f)(!e)))},children:s?Object(R.jsx)(ze.a,{color:"secondary",style:{fontSize:35}}):Object(R.jsx)(Pe.a,{color:"primary",style:{fontSize:35}})}),Object(R.jsx)(ke,{onClickHandler:function(){var e=i;r&&r.getVideoTracks().length>0&&(r.getVideoTracks()[0].enabled=!e,t(Object(X.d)(!e)))},children:i?Object(R.jsx)(Ue.a,{color:"secondary",style:{fontSize:35}}):Object(R.jsx)(Ie.a,{color:"primary",style:{fontSize:35}})})]})})),Ye=Object(h.a)((function(e){return Object(m.a)({localVideoContainer:{backgroundColor:"black",width:"200px",height:"150px",borderRadius:"5px",position:"absolute",top:"10%",right:"10%"},videoElement:{width:"100%",height:"100%"}})})),He=o.a.memo((function(){var e=Ye(),t=Object(L.c)((function(e){return e.call.localStream})),a=Object(L.c)((function(e){return e.call.screenSharingStream})),n=Object(L.c)((function(e){return e.call.isScreenSharing})),c=Object(r.useRef)(null);return Object(r.useEffect)((function(){if(t&&!n){var e=c.current;e&&(e.srcObject=t,e.onloadedmetadata=function(){e.play()})}else{var r=c.current;r&&(r.srcObject=a,r.onloadedmetadata=function(){r.play()})}}),[t,n,a]),Object(R.jsx)("div",{className:e.localVideoContainer,children:Object(R.jsx)("video",{className:e.videoElement,ref:c,autoPlay:!0,muted:!0})})})),We=Object(h.a)((function(e){return Object(m.a)({remoteVideoContainer:{},videoElement:{width:"100%",height:"90vh"}})})),Ge=o.a.memo((function(){var e=We(),t=Object(L.c)((function(e){return e.call.remoteStream})),a=Object(r.useRef)(null);return Object(r.useEffect)((function(){if(t){console.log("REMOTE STREAM",t),console.log("TRACKS",t.getTracks());var e=a.current;e&&(e.srcObject=t,e.onloadedmetadata=function(){e.play()})}}),[t]),Object(R.jsx)("div",{className:e.remoteVideoContainer,children:Object(R.jsx)("video",{className:e.videoElement,ref:a,autoPlay:!0})})})),Fe=o.a.memo((function(){var e=Ee(),t=Object(L.c)((function(e){return e.user.user})),a=Object(L.c)((function(e){return e.call.localStream})),n=Object(L.c)((function(e){return e.call.remoteStream})),c=Object(L.c)((function(e){return e.call.callState})),r=Object(L.c)((function(e){return e.call.name})),o=Object(L.c)((function(e){return e.call.isScreenSharing})),i=Object(L.c)((function(e){return e.call.isCameraEnabled})),s=Object(L.c)((function(e){return e.call.isMicrophoneEnabled}));return Object(R.jsxs)("div",{className:e.root,children:[Object(R.jsx)(He,{}),c===D.b.CALL_REQUESTED?Object(R.jsx)(Ce,{name:r}):null,Object(R.jsxs)("div",{className:n&&c===D.b.CALL_IN_PROGRESS?e.talking:e.pending,children:[t&&c===D.b.CALL_IN_PROGRESS?Object(R.jsx)(Me,{currentUser:t,targetUserId:r,localStream:a,isScreenSharing:o,isCameraEnabled:i,isMicrophoneEnabled:s}):null,n&&c===D.b.CALL_IN_PROGRESS?Object(R.jsx)(Ge,{}):null]})]})})),Je=a(356),Qe=Object(h.a)((function(e){return Object(m.a)({root:{height:"90vh",display:"flex",flexDirection:"column",justifyContent:"flex-end"},messageArea:{overflowY:"scroll"}})})),Xe=a(353),Ke=a(354),qe=Object(h.a)((function(e){return Object(m.a)({messageArea:{display:"flex",width:"100%",overflowY:"auto",overflowX:"hidden"},message:{borderRadius:"10px",boxShadow:"2px 2px 2px 1px rgba(0, 0, 0, 0.3)",margin:"5px",padding:"10px",display:"inline-block",minWidth:"100px",maxWidth:"250px",color:"whitesmoke",wordWrap:"break-word"},right:{justifyContent:"flex-end !important"},left:{justifyContent:"flex-start !important"},byWho:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}})})),Ze=o.a.memo((function(e){var t,a=qe(),c=e.message,r=e.name;return Object(R.jsx)(Xe.a,{children:Object(R.jsx)(n.a,{container:!0,children:Object(R.jsx)(n.a,{item:!0,xs:12,children:Object(R.jsx)("div",{className:"".concat(a.messageArea," ").concat("me"===c.from?a.left:a.right," "),children:Object(R.jsxs)("div",{className:"".concat(a.message),style:"me"===c.from?{background:"#3f51b5"}:{background:"#c77708"},children:[Object(R.jsx)("div",{className:a.byWho,children:Object(R.jsx)("strong",{children:r})}),Object(R.jsx)("div",{children:String(null===(t=c.date)||void 0===t?void 0:t.toLocaleString())}),Object(R.jsx)(Ke.a,{primary:c.message,children:" "})]})})})})})})),$e=Object(h.a)((function(e){return Object(m.a)({messageArea:{overflowY:"scroll"}})})),et=function(e){var t=$e(),a=Object(r.useRef)(null),n=Object(L.c)((function(e){return e.call.textMessages})),c=Object(L.c)((function(e){return e.call.name})),o=Object(L.c)((function(e){return e.user.user}));return Object(r.useEffect)((function(){var e;null===(e=a.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[n]),Object(R.jsx)("div",{className:t.messageArea,children:n.map((function(e,t){return Object(R.jsx)("div",{ref:a,children:Object(R.jsx)(Ze,{message:e,name:"other"===e.from?c:null===o||void 0===o?void 0:o.displayName},t)},t)}))})},tt=a(361),at=a(355),nt=a(313),ct=a.n(nt),rt=function(e){var t=o.a.useState({message:""}),a=Object(i.a)(t,2),c=a[0],r=a[1],s=c.message,l=function(){var e=Object(ee.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),s&&de(s),r((function(e){return{message:""}}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(R.jsx)(n.a,{container:!0,style:{padding:"20px"},children:Object(R.jsxs)("form",{style:{display:"flex",flexFlow:"row wrap",alignItems:"center",width:"95%"},onSubmit:l,noValidate:!0,children:[Object(R.jsx)(n.a,{item:!0,xs:11,children:Object(R.jsx)(tt.a,{id:"outlined-basic-email",label:"Type your message",fullWidth:!0,onChange:function(e){var t=e.target.value;r((function(e){return{message:t}}))},onKeyDown:function(e){"Enter"===e.key&&(s&&(console.log("message",s),de(s)),r((function(e){return{message:""}})))},value:s})}),Object(R.jsx)(n.a,{xs:1,children:Object(R.jsx)(at.a,{color:"primary","aria-label":"send",type:"submit",children:Object(R.jsx)(ct.a,{})})})]})})},ot=function(){var e=Qe();return Object(R.jsxs)("div",{className:e.root,children:[Object(R.jsx)(et,{}),Object(R.jsx)(Je.a,{}),Object(R.jsx)(rt,{})]})},it=a(358),st=a(369),lt=a(357),dt=Object(V.a)((function(e){return Object(m.a)({badge:{backgroundColor:"#44b700",color:"#44b700",boxShadow:"0 0 0 2px ".concat(e.palette.background.paper)}})}))(lt.a),ut=Object(V.a)((function(e){return Object(m.a)({badge:{backgroundColor:"red",color:"red",boxShadow:"0 0 0 2px ".concat(e.palette.background.paper)}})}))(lt.a),bt=function(e){var t=e.displayName,a=(e.fullName,e.from),n=e.self,c=e.busy;return Object(R.jsx)(o.a.Fragment,{children:Object(R.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:Object(R.jsxs)(Xe.a,{button:!0,children:[Object(R.jsx)(it.a,{children:n?Object(R.jsx)(st.a,{alt:t,src:"#"}):c?Object(R.jsx)(ut,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",children:Object(R.jsx)(st.a,{alt:t,src:"#"})}):Object(R.jsx)(dt,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",children:Object(R.jsx)(st.a,{alt:t,src:"#"})})}),Object(R.jsx)(Ke.a,{primary:t}),n||c?null:Object(R.jsx)(J.a,{variant:"contained",onClick:function(e){var n;t&&a&&(n={name:a,target:t,type:"caller"},q.a.dispatch(Object(X.c)(n.target)),q.a.dispatch(Object(X.b)(D.b.CALL_REQUESTED)),q.a.dispatch(Object(X.k)({type:n.type,show:!0})),je.emit("callAttempt",n))},children:"Call"})]},t)})})},jt=a(345),ft=Object(h.a)((function(e){return{usersList:{overflowY:"auto"}}})),pt=o.a.memo((function(e){var t=ft(),a=e.filteredUsers,n=e.activeUsers,c=e.user,r=e.busyUsers;return Object(R.jsx)("div",{className:t.usersList,children:Object(R.jsx)(jt.a,{children:n.length<=1?Object(R.jsx)(Xe.a,{button:!0,children:Object(R.jsx)(Ke.a,{children:"No users online"})},"no_users"):a.filter((function(e){return e!==(null===c||void 0===c?void 0:c.displayName)})).map((function(e,t){return Object(R.jsx)(bt,{displayName:e,from:null===c||void 0===c?void 0:c.displayName,self:!1,busy:r.includes(e)},t)}))})})})),ht=o.a.memo((function(){var e=Object(L.c)((function(e){return e.user.user})),t=Object(L.c)((function(e){return e.chat.activeUsers})),a=Object(L.c)((function(e){return e.chat.busyUsers})),c=Object(r.useState)(""),s=Object(i.a)(c,2),l=s[0],d=s[1],u=t.filter((function(e){return e.toLowerCase().includes(l.toLowerCase())}));return Object(R.jsxs)(o.a.Fragment,{children:[Object(R.jsx)(bt,{displayName:null===e||void 0===e?void 0:e.displayName,fullName:null===e||void 0===e?void 0:e.fullName,self:!0,busy:!0},"currentUser"),Object(R.jsx)(Je.a,{}),Object(R.jsx)(n.a,{item:!0,xs:12,style:{padding:"10px"},children:Object(R.jsx)(tt.a,{id:"outlined-basic-email",label:"Search by user id",variant:"outlined",fullWidth:!0,onChange:function(e){var t=e.target.value;d(t)},InputProps:{spellCheck:"false"}})}),Object(R.jsx)(Je.a,{}),e?Object(R.jsx)(pt,{user:e,filteredUsers:u,activeUsers:t,busyUsers:a}):"You must be logged in"]})})),mt=Object(h.a)((function(e){return{chatSection:{width:"100%",height:"92vh"},borderRight:{borderRight:"1px solid #e0e0e0",padding:"5px"}}})),gt=o.a.memo((function(){var e=mt();return Object(r.useEffect)((function(){return(je=Object(Q.a)("http://localhost:5000",{withCredentials:!0})).on("connect",(function(){fe(je.id)})),je.on("broadcast",(function(e){pe(e)})),je.on("connect_error",(function(e){je.disconnect()})),je.on("webRTC-offer",(function(e){oe(e)})),je.on("webRTC-answer",(function(e){ie(e)})),je.on("webRTC-candidate",(function(e){se(e)})),je.on("callAttempt",(function(e){q.a.dispatch(Object(X.b)(D.b.CALL_REQUESTED)),q.a.dispatch(Object(X.k)({type:e.type,show:!0})),q.a.dispatch(Object(X.c)(e.target))})),je.on("callAttemptResponse",(function(e){e&&he(e)})),je.on("callStatusChange",(function(e){e&&me(e)})),function(){je&&je.disconnect()}}),[]),Object(r.useEffect)((function(){navigator.mediaDevices.getUserMedia(ne).then((function(e){q.a.dispatch(Object(X.e)(e))})).catch((function(e){console.error("Local stream with video/audio failed",e)}))}),[]),Object(R.jsxs)("div",{children:[Object(R.jsx)(I,{}),Object(R.jsxs)(n.a,{container:!0,component:c.a,className:e.chatSection,children:[Object(R.jsx)(n.a,{item:!0,xs:2,className:e.borderRight,children:Object(R.jsx)(ht,{})}),Object(R.jsx)(n.a,{item:!0,xs:6,className:e.borderRight,children:Object(R.jsx)(Fe,{})}),Object(R.jsx)(n.a,{item:!0,xs:4,className:e.borderRight,children:Object(R.jsx)(ot,{})})]})]})}));t.default=gt}}]);
//# sourceMappingURL=8.f02be338.chunk.js.map